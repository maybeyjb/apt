# 钓鱼

取得受害者信任邮件：发信人地址，邮件内容（话术），兴趣话题  

钓鱼就是用----制作网页或者直接就是一个文件。

发件人的邮箱地址伪造  spf---发件人策略框架电子邮件认证机制 ---作用是防止伪造邮件地址

  判断SPF   临时邮箱---是用来防溯源（网上找一个就行）  无spf验证和有spf验证

![image-20241224104756204](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525307.png)

![image-20241224105054614](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525308.png)

无spf验证就直接伪造，有spf就转发或者模糊。

这种就是  ~all ，也就是说 ip除了这个范围都能发，基本就是没验证：

![image-20241224105316827](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525309.png)

![image-20241224105531575](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525310.png)

kali自带工具： swaks   可以伪造邮箱给临时邮箱发送邮件。没有spf验证就直接伪造：

![image-20241224110424396](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525311.png)

大厂一般都有spf验证，方法一般是转发或修改后缀等方法，修改后缀 ：字体上的相似：1--l   0----o---O   域名上的：aliyun--aliyum                      记得先将自己的spf验证打开

这里就是spf验证没有通过，所以没有发给qq.com,他会验证你的发件人和发件的服务地址是否相同（admin.qq.com）,这里明显不一致，所以失败：

![image-20241224110714893](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525312.png)

可以用混淆：

![image-20241224111130250](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525313.png)

转发：  在线邮件系统，作为中转服务器https://www.sendcloud.net/。发给网易，但是进入垃圾箱了，-----重新找个号 继续演示。**API_USER**       Aasddssd@sad

![image-20241224123930769](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525314.png)

![image-20241224124422497](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525316.png)

### gophish

本地工具gophish.exe ，邮件转发、运行后重新更改密码：admin/admin!@#45         打开进行配置：qmgxqmobmfobbhfg 这就是邮箱的使用权，使用口令：

![image-20241224125347255](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525317.png)

制作钓鱼页面：![image-20241224130355344](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525318.png)

这里导入还要注意格式，有的可能会乱码，

![image-20241224131123632](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525319.png)

还可以伪造链接：

![image-20241224132249697](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525320.png)

这里都需要配置：

![image-20241224133637825](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525321.png)

![image-20241224133549050](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525322.png)

然后收到钓鱼的，点击链接会跳转到自己写的网址，但是这里发件人为自己：

![image-20241224133921471](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525323.png)

 伪造来件人

![image-20241224134549769](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525324.png)



最后是成功的，就是会有一个代发的提醒

# SPF

上面就是会有一个代发的提醒，下面这就看怎么绕过

注册一个域名

gophish



![image-20241224191152770](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525325.png)

演示一遍搭建过程

需要申请一个域名，用来演示，这里就不演示了。懒的配环境，这网址就是你自己的服务器，邮件地址就是自己申请的域名，网址建议在香港，域名就搞便宜的。实战肯定是根据目标机来创建域名。

![image-20241224174904656](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525326.png)

然后这里就可以让代发人换成我们创建的域名，配合gohish工具，进行钓鱼：

主要就是在这里换别的都不用太变动，换成test会显示带转发为test

![image-20241224175415459](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525327.png)

这里就更容易上钩，如果在将域名换个像的，更好：

![image-20241224191603771](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525328.png)

# 网页钓鱼



就是上面钓鱼中的链接点开到自己的网页，网页可以是植入木马或程序，搭建的网页冒充真实站点，通过诱使及引导让受害者下载后门文件或登录自身用户凭据，从而获取目标相关资产信息或权限。

需要处理的是：网页的内容，域名。

#### 工具

  用kali工具setoolkit来制造一个网页、还是有点缺陷的，对大型网站复原的不太好。3站点克隆

![image-20241224232754897](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525329.png)

复制成功，有点小瑕疵，毕竟是个大战：

![image-20241224233348624](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525330.png)

这里还能捕获到登录的账号密码，密码是jd自己的加密：

![image-20241224233643087](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525331.png)



登录几个方法：账户密码、扫码、手机短信验证。

 武大的，可以接收到输入的信息，   

制作网页大多数是获取用户登录密码，但是大多密码都是加密的，所以这里就需要解密，JS逆向    这种网站就可以抓到（小网站）：

![image-20241225230237736](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525332.png)

这里动态码抓到了，明文：

![image-20241225230719836](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525333.png)

这种二维码就抓不到：

![image-20241225231759977](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525334.png)

##### 2

  国产的，gobin，     构造页面用gobin.yaml，构造攻击用demo.yaml。抓取账号信息在access.log中

工具的优点就是方便，但是缺点很明显：是借助的原本网页的流量，来伪造的，所以这里加密方式也是别人的，需要自己解密。类似于端口映射。

![image-20241225232335833](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525335.png)

![image-20241225232616061](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525336.png)



![image-20241225232449433](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525337.png)



![image-20241225232854753](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525338.png)

抓取：这里密码还是密文

![image-20241225233235069](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525339.png)

#### 手工

 自己手工的优点：就是解决加密的逻辑的地方，这里是将要制作的网页先另存为，然后找加解密的地方。

这里以jd的登录页面为例子：

![image-20241226121047727](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525340.png)

在找到登录框按钮的位置：

![image-20241226121419072](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525341.png)

定位完成后：

开始手工制作钓鱼页面。

更改3段地方，最后让把登录的账户密码给我们写的post.php脚本中：

![image-20241226124149780](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525342.png)



![image-20241226123911076](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525343.png)

post.php：

![image-20241226125123154](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525344.png)

![image-20241226124928611](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525345.png)

![image-20241226124742791](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525346.png)

   如果登录为扫二维码登录。思路：（异步调用）将自己本地的二维码放到钓鱼网页上，然后让目标扫，在自己本地进行登录。一般来说扫的二维码都是http:\\weixin..........的网页，这里就找到替换成自己的。

思路：就是将钓鱼页面的网站二维码换成自己这边在线的二维码，让鱼儿扫钓鱼页面的，然后自己这边就成功登录鱼儿的账号。

![image-20241226125641632](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161525347.png)

二维码没有搞出来，下节课继续。思路比较重要。

